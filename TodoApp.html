<html>
  <head>
    <style>
      body {
        background-color: #1d2126;
        color: white;
      }
    </style>
<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
  </head>
  <body>
    <div id="root"> </div>
  
   <script type="text/babel">
      
      class TodoList extends React.Component {
        constructor(props){
          super(props);
          this.state = {todos: 
                        [{description: "walk dog", complete: false }, 
                         {description: "brush teeth", complete: false}]
                       }
          this.deleteTodo = this.deleteTodo.bind(this)
          this.handleComplete = this.handleComplete.bind(this)
          //  add this line to ensure that the delete/handleComplete function has access to the state of the parent
        }
//         mark complete
//         delete a todo
        deleteTodo(e, description, idx){
          // we pass in the description so we can find it in the state later

          e.preventDefault();
          console.log("delete")

          let newTodos = this.state.todos.slice()
          // make a copy of the todos
          newTodos.splice(idx, 1)
          // we don't need to iterate over the array to find the one to delete if we pass the index to the function
          // we can then ignore the description argument or remove it if we want to

          // newTodos = newTodos.reduce((acc, curr)=>{

          //   if (curr.description !== description){
          //     acc.push(curr)
          //   }
          //     return acc
          // }, [])
          // // filter out the one selected for deletion

          this.setState({todos: newTodos})

        }
        
        handleComplete(e, description, idx){
          e.preventDefault();
          console.log("toggle complete");
          let newTodos = this.state.todos.slice();
          // copy todos

          newTodos[idx].complete = !newTodos[idx].complete
          // we can avoid iterating over the array of todos if we pass the index in
          // and we no longer need the description argument

          // newTodos = newTodos.reduce((acc, curr)=> {

          //     if (curr.description === description){
          //       curr.completed = !(curr.completed)
          //     }
          //     acc.push(curr)
          //     return acc
          // }, [] )

          this.setState({todos: newTodos});
        }
        
        
        render(){
          let todos = this.state.todos.map((todo, i)=> 
                      <TodoListItemFunctional key={todo.description}
                        index= {i}
                        deleteTodo={this.deleteTodo} 
                        handleComplete={this.handleComplete} 
                        todo={todo} 
                      /> )

//       pass down mark complete and delete functions
          return(
            <div>
            <div>inside</div> 
            // {todos}
           </div>
          )
        }
      }
    
//       todolistitem
      


      class TodoListItem extends React.Component {
        // this is the implementation for a stateful component, 
        // but for something this straight forward, 
        // we could probably pivot this to a functional component
      
        constructor(props){
          super(props)       
          // this.state = this.props.todo;
          // we don't need this above line if we plan to let the parent manage the state
          this.deleteTodo = this.props.deleteTodo.bind(this)
          this.handleComplete = this.props.handleComplete.bind(this);
        }
         
        render(){
          let todo = this.props.todo;         
          let index = this.props.index
          let completedVar = todo.complete ? "Completed" : "In Progress";
          return (
            <div>
              <h2>{todo.description}</h2>
              <input type="submit" value ={completedVar} onClick={e=> this.handleComplete(e, todo.description, index)} />
              <input type="submit" value="Delete Todo?" onClick={e=> this.deleteTodo(e, todo.description, index)} /> 
            </div>
          )
        }
      }

      const TodoListItemFunctional = ({todo, deleteTodo, handleComplete, index}) => {
        // for such a basic component like this we could alternatively use a functional component 
        // and defer all prop management to the parent
        let completedVar = todo.complete ? "Completed" : "In Progress";
        return (
          <div>
            <h2>{todo.description}</h2>
              <input type="submit" value ={completedVar} onClick={e=> handleComplete(e, todo.description, index)} />
              <input type="submit" value="Delete Todo?" onClick={e=> deleteTodo(e, todo.description, index)} /> 
          </div>
        )
      }
      
      ReactDOM.render(<TodoList />, document.getElementById("root"))
    </script>
    </body>
</html>

<!-- todo list component -->
<!-- todo component -->
hello

<!-- Finish writing the function to delete a todo -->
<!-- finish writing the function to mark a todo as completed -->
<!-- convert the stateful TodoListItem Component to a functional component -->
<!-- optimizations -->
style the todo list items
